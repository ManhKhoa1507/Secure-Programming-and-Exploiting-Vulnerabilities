#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

int xorlen = 0;
int count = 0;

void Shell() { system("/bin/sh"); }

void Welcome() {
  puts("Wanna.One");
  puts("Muon gioi phai lam viec kho");
}

void Read_Input(char *buf, unsigned int size) {
  int ret;
  ret = read(0, buf, size);
  if (ret <= 0) {
    puts("read error");
    exit(1);
  }
}

void Handler(int signum) {
  puts("Timeout");
  _exit(1);
}
void init() {
  setvbuf(stdout, 0, _IONBF, 0);
  setvbuf(stdin, 0, _IONBF, 0);
  setvbuf(stderr, 0, _IONBF, 0);
  signal(SIGALRM, Handler);
  alarm(180);
}

void Xorstr(char *str) {
  char key[128];
  char result[128];

  printf("What do you want to xor :");
  Read_Input(key, 128);
  xorlen = strlen(key);

  for (count = 0; count < xorlen; count++) {
    result[count] = str[count] ^ key[count];
  }
  puts("\nXor string: ");
  puts(&result);
}

void Magic() {
  char str[128];
  printf("Your string:");
  Read_Input(str, 128);
  Xorstr(str);
  return;
}
void Vuln() {
  char buf[128];
  puts("Viet Nam se chien thang dai dich!!!");
  gets(buf);
}

void Menu() {
  puts("1: Xor string");
  puts("2: Vuln");
}

int main() {
  init();
  Welcome();
  int choice;

  while (1) {
    Menu();
    scanf("%d", &choice);

    switch (choice) {
    case 1:
      Magic();
      break;

    case 2:
      Vuln();
      break;

    default:
      puts("invaild choice!!!");
    }
  }
  return 0;
}